<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cooldown Manager - Final Feature Set (81 Features, ‚â•90% Viable)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js" integrity="sha512-M7nHCiNUOwFt6Us3r8alutZLm9qMt4s9951uo8jqO4UwJ1hziseL6O3ndFyigx6+LREfZqnhHxYjKRJ8ZQ69DQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            overflow: hidden;
        }

        #header {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1000;
        }

        #header h1 {
            margin: 0 0 5px 0;
            font-size: 24px;
            font-weight: 600;
        }

        #header p {
            margin: 0;
            font-size: 14px;
            color: #a0aec0;
        }

        #stats {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
        }

        .stat-label {
            color: #a0aec0;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            color: #4ade80;
            font-size: 18px;
            font-weight: 700;
        }

        #controls {
            position: absolute;
            top: 100px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        #controls h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: white;
        }

        button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 8px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .node circle {
            fill: #fff;
            stroke: steelblue;
            stroke-width: 3px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .node.root circle {
            fill: #667eea;
            stroke: #764ba2;
            stroke-width: 4px;
        }

        .node.category circle {
            fill: #4ade80;
            stroke: #22c55e;
        }

        .node circle:hover {
            fill: #fbbf24;
            stroke: #f59e0b;
            stroke-width: 4px;
        }

        .node text {
            font-size: 12px;
            font-weight: 500;
            fill: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
            pointer-events: none;
        }

        .node.root text {
            font-size: 16px;
            font-weight: 700;
        }

        .node.category text {
            font-size: 13px;
            font-weight: 600;
        }

        .link {
            fill: none;
            stroke: rgba(255, 255, 255, 0.3);
            stroke-width: 2px;
            transition: stroke 0.3s;
        }

        .link:hover {
            stroke: rgba(251, 191, 36, 0.8);
            stroke-width: 3px;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            line-height: 1.6;
            max-width: 400px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 2000;
        }

        .tooltip.visible {
            opacity: 1;
        }

        .tooltip-title {
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 8px;
            color: #4ade80;
        }

        .tooltip-viability {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            color: #a0aec0;
            font-size: 12px;
            white-space: pre-line;
        }

        #mindmap {
            width: 100%;
            height: calc(100vh - 120px);
        }

        .zoom-info {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 11px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>üéÆ Cooldown Manager - Final Feature Set</h1>
        <p>Interactive Feature Mindmap | WoW 12.0.0 (Midnight) Compatibility Assessment | Now with Threat Bar!</p>
        <div id="stats">
            <div class="stat">
                <div class="stat-label">Total Features</div>
                <div class="stat-value">81</div>
            </div>
            <div class="stat">
                <div class="stat-label">Avg Viability</div>
                <div class="stat-value">99.4%</div>
            </div>
            <div class="stat">
                <div class="stat-label">Min Viability</div>
                <div class="stat-value">90%</div>
            </div>
            <div class="stat">
                <div class="stat-label">Categories</div>
                <div class="stat-value">10</div>
            </div>
        </div>
    </div>

    <div id="controls">
        <h3>Controls</h3>
        <button onclick="expandAll()">Expand All</button>
        <button onclick="collapseAll()">Collapse All</button>
        <button onclick="resetZoom()">Reset View</button>
    </div>

    <div class="zoom-info">
        üí° Scroll to zoom | Drag to pan | Click nodes to expand/collapse | Hover for details
    </div>

    <div id="mindmap"></div>
    <div class="tooltip"></div>

    <script>
        // Wait for DOM and check D3
        document.addEventListener('DOMContentLoaded', function() {
            // Give a moment for external script to load
            setTimeout(function() {
                if (typeof d3 === 'undefined') {
                    document.body.innerHTML = `
                        <div style="padding: 40px; text-align: center; font-family: sans-serif; background: #1e3c72; color: white; min-height: 100vh;">
                            <h1>‚ùå D3.js Library Failed to Load</h1>
                            <p style="font-size: 18px; margin: 20px 0;">The visualization library could not be loaded from the CDN.</p>
                            <p style="font-size: 14px; color: #a0aec0;">Possible causes:</p>
                            <ul style="text-align: left; max-width: 500px; margin: 20px auto; color: #a0aec0;">
                                <li>No internet connection</li>
                                <li>Firewall or content blocker preventing CDN access</li>
                                <li>Browser security settings</li>
                            </ul>
                            <p style="font-size: 14px; color: #4ade80; margin-top: 30px;">‚úÖ Solution: Use the simplified "cooldown-manager-feature-list.html" file instead (no external dependencies)</p>
                        </div>
                    `;
                    return;
                }
                // D3 loaded successfully, initialize
                initializeMindmap();
            }, 100);
        });

        function initializeMindmap() {
        // Load feature data
        const data = {
    name: "Cooldown Manager\nRefined Feature Set",
    className: "root",
    children: [
        {
            name: "Advanced Spell &\nAbility Control",
            className: "category",
            children: [
                { 
                    name: "Show/hide by Spell ID", 
                    description: "Allows you to enter numerical Spell IDs to manually toggle visibility of individual abilities, buffs, or debuffs in your trackers.\n\n‚úÖ Viability: 100% - Fully supported via C_Spell.GetSpellCooldown()"
                },
                { 
                    name: "Manual add/remove spells, buffs, debuffs, items", 
                    description: "Lets you add any ability or item to your tracking bars by name or ID, not just what Blizzard pre-selects for you.\n\n‚úÖ Viability: 100% - Fully supported via SavedVariables and spell/item APIs"
                },
                { 
                    name: "Custom tracking groups", 
                    description: "Create your own organizational folders (like 'Offensive CDs', 'Defensives', 'Procs') and assign abilities to them however you want.\n\n‚úÖ Viability: 100% - Pure data structure, no API restrictions"
                },
                { 
                    name: "Ability prioritization & reordering", 
                    description: "Drag-and-drop or set numeric priority to control which abilities appear first/most prominently in your display.\n\n‚úÖ Viability: 100% - UI sorting logic, fully supported"
                },
                { 
                    name: "Automatic trinket tracking", 
                    description: "Automatically detects and adds your equipped trinkets to cooldown trackers without manual configuration.\n\n‚úÖ Viability: 100% - GetInventoryItemID() and PLAYER_EQUIPMENT_CHANGED event"
                },
                { 
                    name: "Custom spell bars", 
                    description: "Create dedicated tracking bars for specific spells you want to monitor separately from main cooldown groups.\n\n‚úÖ Viability: 100% - UI frame creation fully supported"
                },
                { 
                    name: "Custom item bars (potions, flasks, consumables)", 
                    description: "Set up tracking for consumables and usable items so you can monitor potion cooldowns, flask durations, etc.\n\n‚úÖ Viability: 100% - C_Container.GetItemCooldown() fully supported"
                },
                { 
                    name: "Separate important cooldowns display", 
                    description: "Pull critical abilities (like major defensives) into their own standalone tracker away from less important cooldowns.\n\n‚úÖ Viability: 100% - Multiple frame creation supported"
                },
                { 
                    name: "Per-icon custom overrides", 
                    description: "Override global settings for individual abilities (make one icon larger, position it differently, use unique colors, etc.).\n\n‚úÖ Viability: 100% - Per-element configuration via SavedVariables"
                },
                { 
                    name: "Class-specific ability presets", 
                    description: "Pre-configured tracking lists tailored to each class/spec that include all important abilities out of the box.\n\n‚úÖ Viability: 100% - Static configuration data"
                },
                { 
                    name: "Charge spell handling options", 
                    description: "Controls whether charge-based abilities (like Fire Blast) show on cooldown immediately or only when all charges are depleted.\n\n‚úÖ Viability: 100% - GetSpellCharges() fully supported"
                }
            ]
        },
        {
            name: "Flexible Layout &\nPositioning System",
            className: "category",
            children: [
                { 
                    name: "Multiple layout patterns (rows, columns, grids, free-form)", 
                    description: "Choose from organized row/column grids or completely custom free-form positioning for your cooldown icons.\n\n‚úÖ Viability: 100% - Frame positioning unrestricted"
                },
                { 
                    name: "Customizable orientation & growth direction", 
                    description: "Set whether new icons appear horizontally or vertically, and which direction they grow (up, down, left, right).\n\n‚úÖ Viability: 100% - SetPoint() and frame anchoring fully supported"
                },
                { 
                    name: "Alignment options (left, center, right)", 
                    description: "Align your cooldown icons to the left, center, or right within their container for cleaner organization.\n\n‚úÖ Viability: 100% - Layout calculation unrestricted"
                },
                { 
                    name: "Flexible anchor points", 
                    description: "Icons can anchor from any corner or edge, not just growing from the center like default UI.\n\n‚úÖ Viability: 100% - All anchor points available"
                },
                { 
                    name: "Custom spacing/padding controls", 
                    description: "Adjust the exact pixel spacing between icons and the padding around groups to match your aesthetic.\n\n‚úÖ Viability: 100% - Numeric offset controls fully supported"
                },
                { 
                    name: "Dynamic adaptive layouts", 
                    description: "Icons automatically reposition themselves based on which abilities are active, preventing gaps in your tracking grid.\n\n‚úÖ Viability: 100% - Event-driven repositioning logic"
                },
                { 
                    name: "Position anywhere on screen", 
                    description: "Place tracking windows wherever you want without being limited to Blizzard's Edit Mode grid system.\n\n‚úÖ Viability: 100% - Frame:SetPoint() unrestricted"
                },
                { 
                    name: "Anchor to other frames", 
                    description: "Attach your trackers to action bars or any other UI element with precise X/Y offset control.\n\n‚úÖ Viability: 100% - Relative positioning fully supported"
                },
                { 
                    name: "Enhanced snapping & alignment guides", 
                    description: "Visual guides appear when positioning frames to help you align them perfectly with other UI elements.\n\n‚úÖ Viability: 100% - UI overlay rendering unrestricted"
                },
                { 
                    name: "Screen boundary protection", 
                    description: "Prevents your tracking frames from accidentally being positioned off-screen where you can't see them.\n\n‚úÖ Viability: 100% - GetScreenWidth/Height() available"
                },
                { 
                    name: "Multiple independent tracking windows", 
                    description: "Create several separate tracking windows with completely different layouts and positions.\n\n‚úÖ Viability: 100% - Unlimited frame creation supported"
                }
            ]
        },
        {
            name: "Comprehensive Visual\nCustomization",
            className: "category",
            children: [
                { 
                    name: "Custom icon sizes & bar lengths", 
                    description: "Set the exact pixel dimensions for icons and bars, making important cooldowns larger and less critical ones smaller.\n\n‚úÖ Viability: 100% - Frame:SetSize() unrestricted"
                },
                { 
                    name: "Independent element scaling", 
                    description: "Scale different types of trackers independently (make buffs smaller, cooldowns larger, etc.) without affecting the whole UI.\n\n‚úÖ Viability: 100% - Frame:SetScale() per element"
                },
                { 
                    name: "Border customization", 
                    description: "Choose border styles (pixel perfect, rounded, glowing) and adjust thickness, or remove borders entirely for a cleaner look.\n\n‚úÖ Viability: 100% - Texture and backdrop APIs fully available"
                },
                { 
                    name: "Masque skin support", 
                    description: "Apply popular icon skin addons like Masque to give your cooldowns a consistent look with the rest of your UI.\n\n‚úÖ Viability: 100% - Masque library integration supported"
                },
                { 
                    name: "Independent text scaling & positioning", 
                    description: "Resize and reposition cooldown numbers, stack counts, and duration text separately from the icons themselves.\n\n‚úÖ Viability: 100% - FontString manipulation unrestricted"
                },
                { 
                    name: "Keybind display on icons", 
                    description: "Show your keybindings directly on cooldown icons so you know which key to press without looking at action bars.\n\n‚úÖ Viability: 100% - GetBindingKey() fully supported"
                },
                { 
                    name: "Font settings for all text elements", 
                    description: "Customize fonts, sizes, colors, and outlines for cooldown timers, stack numbers, keybinds, and duration text.\n\n‚úÖ Viability: 100% - FontString:SetFont/Color/Shadow unrestricted"
                },
                { 
                    name: "Individual element positioning", 
                    description: "Move text, icons, and borders independently within a frame for pixel-perfect customization.\n\n‚úÖ Viability: 100% - Child frame anchoring fully available"
                },
                { 
                    name: "Minimalist aesthetic options", 
                    description: "Clean, simplified visual modes that remove clutter and focus on essential information only.\n\n‚úÖ Viability: 100% - Conditional rendering logic"
                },
                { 
                    name: "Custom cooldown swipe colors", 
                    description: "Change the color of the cooldown sweep animation to match your UI theme or make it more visible.\n\n‚úÖ Viability: 100% - Cooldown:SetSwipeColor() available"
                },
                { 
                    name: "Proc glow customization", 
                    description: "Adjust the color, intensity, and animation style of the glow effect when abilities become available.\n\n‚úÖ Viability: 100% - Animation and texture alpha manipulation"
                },
                { 
                    name: "Desaturation control for inactive abilities", 
                    description: "Control whether inactive abilities appear in full color, greyscale, or somewhere in between.\n\n‚úÖ Viability: 100% - Texture:SetDesaturated() available"
                }
            ]
        },
        {
            name: "Color & Display\nOptions",
            className: "category",
            children: [
                { 
                    name: "Visual resource threshold indicators", 
                    description: "Highlight or change colors when you reach specific resource amounts (e.g., enough energy to cast an expensive ability).\n\n‚úÖ Viability: 100% - Player power values non-secret, color changes unrestricted"
                },
                { 
                    name: "Dispellable debuff highlighting", 
                    description: "Automatically highlight debuffs on yourself that you can dispel with special borders or colors for quick identification.\n\n‚úÖ Viability: 90% - UnitAura() provides dispel type; some combat values may be secret but dispel info available"
                }
            ]
        },
        {
            name: "Information Density\n& Organization",
            className: "category",
            children: [
                { 
                    name: "Categorized tracking windows", 
                    description: "Separate trackers into distinct categories like offensive cooldowns, defensives, utilities, buffs, debuffs, and resources.\n\n‚úÖ Viability: 100% - Multiple frame organization logic"
                },
                { 
                    name: "Conditional display rules", 
                    description: "Set rules to show trackers only in combat, only out of combat, only when abilities are available, or only when on cooldown.\n\n‚úÖ Viability: 100% - PLAYER_REGEN event and cooldown state checks"
                },
                { 
                    name: "Filter options to reduce clutter", 
                    description: "Hide abilities based on criteria like cooldown length, passive procs, or importance to reduce visual noise.\n\n‚úÖ Viability: 100% - Filtering logic based on ability metadata"
                },
                { 
                    name: "Grouped related abilities", 
                    description: "Automatically group related abilities together (e.g., combo point builders with finishers, essence spenders with generators).\n\n‚úÖ Viability: 100% - Spell categorization via static data"
                },
                { 
                    name: "Custom spell icon groups", 
                    description: "Create custom groups beyond what Cooldown Manager offers to track specific ability combinations or rotations.\n\n‚úÖ Viability: 100% - User-defined grouping in SavedVariables"
                },
                { 
                    name: "Smart sorting options", 
                    description: "Automatically sort abilities by remaining cooldown time, importance level, alphabetically, or your custom order.\n\n‚úÖ Viability: 100% - Table sorting with custom comparators"
                },
                { 
                    name: "Separate trackers for content types (PvE/PvP)", 
                    description: "Load different tracking configurations automatically when entering PvE dungeons/raids versus PvP arenas/battlegrounds.\n\n‚úÖ Viability: 100% - Zone detection and profile switching"
                },
                { 
                    name: "Prevent icon overlap", 
                    description: "Ensure icons never overlap each other even with dynamic positioning or when many abilities are active simultaneously.\n\n‚úÖ Viability: 100% - Collision detection algorithms"
                }
            ]
        },
        {
            name: "Profile & Configuration\nManagement",
            className: "category",
            children: [
                { 
                    name: "Profile import/export", 
                    description: "Share your complete addon configuration with others via export strings, or import their setups to try them out.\n\n‚úÖ Viability: 100% - LibSerialize + LibDeflate for encoding/compression"
                },
                { 
                    name: "Dual spec support", 
                    description: "Automatically switch tracking profiles when you change specializations so each spec has its own customized setup.\n\n‚úÖ Viability: 100% - ACTIVE_TALENT_GROUP_CHANGED event"
                },
                { 
                    name: "Saved loadout system (one-click switching)", 
                    description: "Create named profiles (Raid, M+, PvP, Leveling) and switch between them instantly with a single click.\n\n‚úÖ Viability: 100% - Profile management in SavedVariables"
                },
                { 
                    name: "Per-character, per-spec, account-wide options", 
                    description: "Choose whether settings apply to all characters, just one character, specific specs, or account-wide.\n\n‚úÖ Viability: 100% - SavedVariables vs SavedVariablesPerCharacter"
                },
                { 
                    name: "Database management", 
                    description: "Built-in tools to clean up old profiles, reset corrupted settings, and optimize saved variable storage.\n\n‚úÖ Viability: 100% - SavedVariables manipulation unrestricted"
                },
                { 
                    name: "Simplified configuration wizard", 
                    description: "Step-by-step setup process that helps new users configure the addon without being overwhelmed by options.\n\n‚úÖ Viability: 100% - UI flow logic unrestricted"
                },
                { 
                    name: "Profile templates (tank, healer, DPS)", 
                    description: "Pre-made configurations optimized for each role that you can use as-is or customize to your liking.\n\n‚úÖ Viability: 100% - Static template data"
                },
                { 
                    name: "Backup and restore for profiles", 
                    description: "Create backups of your configurations before major changes and restore them if something goes wrong.\n\n‚úÖ Viability: 100% - Deep table copying functions"
                }
            ]
        },
        {
            name: "Accessibility &\nUser Experience",
            className: "category",
            children: [
                { 
                    name: "Simplified UI mode", 
                    description: "A streamlined interface showing only essential options for users who don't want to dive into advanced configuration.\n\n‚úÖ Viability: 100% - Conditional UI element display"
                },
                { 
                    name: "Quick toggle buttons", 
                    description: "One-click buttons to show/hide entire categories, enable combat-only mode, or toggle between profiles.\n\n‚úÖ Viability: 100% - Button:SetScript('OnClick') unrestricted"
                },
                { 
                    name: "Slash commands", 
                    description: "Type commands like /cdm config or /cdm toggle to quickly access settings without clicking through menus.\n\n‚úÖ Viability: 100% - SLASH_COMMANDS registration fully supported"
                },
                { 
                    name: "Minimap integration", 
                    description: "Access addon settings via the minimap button or addon compartment for convenient configuration.\n\n‚úÖ Viability: 100% - LibDBIcon or AddonCompartment API"
                },
                { 
                    name: "In-game configuration windows", 
                    description: "Configure everything without leaving the game using intuitive panels that update in real-time.\n\n‚úÖ Viability: 100% - InterfaceOptionsFrame or AceConfig"
                },
                { 
                    name: "Visual accessibility options", 
                    description: "High contrast modes, larger text and icons, reduced animations for users with visual processing needs.\n\n‚úÖ Viability: 100% - All visual customization APIs available"
                },
                { 
                    name: "Reduced complexity modes", 
                    description: "Simplified modes for users with sensory processing issues or those who prefer minimal visual information.\n\n‚úÖ Viability: 100% - Feature toggling via settings"
                },
                { 
                    name: "Tooltips & help system", 
                    description: "Hover over any option to see an explanation of what it does and how it affects your tracking.\n\n‚úÖ Viability: 100% - GameTooltip manipulation fully available"
                },
                { 
                    name: "Undo/redo for configuration", 
                    description: "Made a mistake while configuring? Undo recent changes or redo them if you changed your mind.\n\n‚úÖ Viability: 100% - Configuration history stack in memory"
                },
                { 
                    name: "Feature toggles per viewer type", 
                    description: "Enable or disable specific features independently for Essential, Utility, Buff Icons, and Buff Bars.\n\n‚úÖ Viability: 100% - Per-module configuration flags"
                },
                { 
                    name: "Shareable configuration strings", 
                    description: "Generate encoded strings of your configuration that can be shared on Discord, forums, or in-game chat.\n\n‚úÖ Viability: 100% - Base64 encoding + compression libraries"
                }
            ]
        },
        {
            name: "Integration &\nCompatibility",
            className: "category",
            children: [
                { 
                    name: "API for other addons", 
                    description: "Developers can extend the addon with custom anchors, tracking categories, or integration with their own addons.\n\n‚úÖ Viability: 100% - Public API via _G namespace"
                },
                { 
                    name: "LibSharedMedia support", 
                    description: "Access additional fonts, textures, and borders from the LibSharedMedia library used by many popular addons.\n\n‚úÖ Viability: 100% - LSM-3.0 library integration"
                },
                { 
                    name: "Compatibility toggles", 
                    description: "Enable/disable specific features to work around conflicts with other UI addons automatically.\n\n‚úÖ Viability: 100% - Conflict detection and feature flags"
                },
                { 
                    name: "ElvUI auto-compatibility mode", 
                    description: "Detects ElvUI and automatically adjusts styling and positioning to match ElvUI's aesthetic and behavior.\n\n‚úÖ Viability: 100% - ElvUI detection via _G.ElvUI check"
                },
                { 
                    name: "Main action bar hiding option", 
                    description: "Hide Blizzard's main action bar while using Cooldown Manager so you don't have duplicate ability displays.\n\n‚úÖ Viability: 100% - MainMenuBar:Hide() or Edit Mode API"
                },
                { 
                    name: "Conflict resolution system", 
                    description: "Automatically detects conflicts with other addons and offers solutions or temporary workarounds.\n\n‚úÖ Viability: 100% - Addon detection and hook management"
                }
            ]
        },
        {
            name: "Advanced Tracking\nFeatures",
            className: "category",
            children: [
                { 
                    name: "GCD tracking visualization", 
                    description: "Separate global cooldown visualization that shows the 1.5s GCD independently from ability-specific cooldowns.\n\n‚úÖ Viability: 100% - GCD spell ID 61304 explicitly whitelisted in WoW 12.0"
                },
                { 
                    name: "Combo point/resource builder differentiation", 
                    description: "Visually distinguish between abilities that generate resources and those that spend them.\n\n‚úÖ Viability: 100% - Spell categorization via static data or spell info"
                },
                { 
                    name: "Threat/Aggro bar tracking", 
                    description: "Visual status bar showing player's threat percentage in combat. Auto-appears on combat start, fills 0-100% based on threat level, color-codes from green (safe) ‚Üí yellow (warning) ‚Üí red (tanking). Shows 'TANKING' at 100% aggro. Particularly useful for tanks and threat-sensitive DPS.\n\n‚úÖ Viability: 95% - UnitDetailedThreatSituation() available for player's target. Some restrictions on nameplate scanning in WoW 12.0 but player threat data is whitelisted. Recommended implementation focuses on player's current target."
                }
            ]
        },
        {
            name: "Performance &\nQuality of Life",
            className: "category",
            children: [
                { 
                    name: "Auto-adjust width for bars", 
                    description: "Tracking bars automatically resize to fit your layout without manual width adjustments.\n\n‚úÖ Viability: 100% - Dynamic width calculation based on content"
                },
                { 
                    name: "No-bloat optimization", 
                    description: "Efficient code that minimizes memory usage and CPU impact for smooth performance even in 40-player raids.\n\n‚úÖ Viability: 100% - Code optimization techniques unrestricted"
                },
                { 
                    name: "Direct settings access", 
                    description: "Quick access commands that open specific settings panels directly without navigating through multiple menus.\n\n‚úÖ Viability: 100% - InterfaceOptionsFrame_OpenToCategory()"
                },
                { 
                    name: "Memory & CPU optimization", 
                    description: "Advanced memory pooling and efficient update cycles to keep addon performance impact minimal.\n\n‚úÖ Viability: 100% - Object pooling and throttling patterns"
                },
                { 
                    name: "Lazy loading for config panels", 
                    description: "Configuration panels only load when you open them, reducing initial load time and memory usage.\n\n‚úÖ Viability: 100% - On-demand module loading"
                },
                { 
                    name: "Performance monitoring dashboard", 
                    description: "Built-in tools to monitor the addon's memory usage, update frequency, and performance impact.\n\n‚úÖ Viability: 100% - GetAddOnMemoryUsage() and profiling"
                },
                { 
                    name: "Cache management", 
                    description: "Intelligent caching of frequently accessed data (spell info, item details) to reduce API calls and improve responsiveness.\n\n‚úÖ Viability: 100% - In-memory caching unrestricted"
                },
                { 
                    name: "Combat lockdown handling", 
                    description: "Queues configuration changes made during combat to apply automatically when you leave combat.\n\n‚úÖ Viability: 100% - InCombatLockdown() and PLAYER_REGEN_ENABLED event"
                },
                { 
                    name: "Smart update throttling", 
                    description: "Reduces unnecessary frame updates by only refreshing when values actually change, not every frame.\n\n‚úÖ Viability: 100% - Event-driven updates vs OnUpdate polling"
                }
            ]
        }
    ]
};

        // Set up dimensions
        const width = window.innerWidth;
        const height = window.innerHeight - 120;

        // Create SVG
        svg = d3.select("#mindmap")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        const g = svg.append("g");

        // Create zoom behavior
        zoom = d3.zoom()
            .scaleExtent([0.1, 3])
            .on("zoom", (event) => {
                g.attr("transform", event.transform);
            });

        svg.call(zoom);

        // Create tree layout
        const tree = d3.tree()
            .size([height - 100, width - 400])
            .separation((a, b) => (a.parent === b.parent ? 1 : 1.2));

        // Create hierarchy
        root = d3.hierarchy(data);
        root.x0 = height / 2;
        root.y0 = 0;

        // Collapse all children initially
        root.children.forEach(collapse);

        // Update function
        function update(source) {
            const treeData = tree(root);
            const nodes = treeData.descendants();
            const links = treeData.links();

            // Normalize for fixed-depth
            nodes.forEach(d => {
                d.y = d.depth * 250;
            });

            // Update nodes
            const node = g.selectAll("g.node")
                .data(nodes, d => d.id || (d.id = Math.random()));

            const nodeEnter = node.enter()
                .append("g")
                .attr("class", d => `node ${d.data.className || ''}`)
                .attr("transform", d => `translate(${source.y0},${source.x0})`)
                .on("click", (event, d) => {
                    if (d.children) {
                        collapse(d);
                    } else if (d._children) {
                        expand(d);
                    }
                    update(d);
                })
                .on("mouseover", (event, d) => {
                    if (d.data.description) {
                        const tooltip = d3.select(".tooltip");
                        tooltip.html(`
                            <div class="tooltip-title">${d.data.name.replace(/\n/g, ' ')}</div>
                            <div>${d.data.description}</div>
                        `)
                        .style("left", (event.pageX + 15) + "px")
                        .style("top", (event.pageY + 15) + "px")
                        .classed("visible", true);
                    }
                })
                .on("mouseout", () => {
                    d3.select(".tooltip").classed("visible", false);
                });

            nodeEnter.append("circle")
                .attr("r", d => d.data.className === 'root' ? 12 : d.data.className === 'category' ? 8 : 6);

            nodeEnter.append("text")
                .attr("dy", d => d.data.className === 'root' ? "-20px" : "-12px")
                .attr("text-anchor", "middle")
                .text(d => d.data.name);

            const nodeUpdate = nodeEnter.merge(node);

            nodeUpdate.transition()
                .duration(500)
                .attr("transform", d => `translate(${d.y},${d.x})`);

            const nodeExit = node.exit()
                .transition()
                .duration(500)
                .attr("transform", d => `translate(${source.y},${source.x})`)
                .remove();

            // Update links
            const link = g.selectAll("path.link")
                .data(links, d => d.target.id);

            const linkEnter = link.enter()
                .insert("path", "g")
                .attr("class", "link")
                .attr("d", d => {
                    const o = {x: source.x0, y: source.y0};
                    return diagonal(o, o);
                });

            const linkUpdate = linkEnter.merge(link);

            linkUpdate.transition()
                .duration(500)
                .attr("d", d => diagonal(d.source, d.target));

            link.exit()
                .transition()
                .duration(500)
                .attr("d", d => {
                    const o = {x: source.x, y: source.y};
                    return diagonal(o, o);
                })
                .remove();

            nodes.forEach(d => {
                d.x0 = d.x;
                d.y0 = d.y;
            });
        }

        // Diagonal line generator
        function diagonal(s, d) {
            return `M ${s.y} ${s.x}
                    C ${(s.y + d.y) / 2} ${s.x},
                      ${(s.y + d.y) / 2} ${d.x},
                      ${d.y} ${d.x}`;
        }

        // Collapse node
        function collapse(d) {
            if (d.children) {
                d._children = d.children;
                d._children.forEach(collapse);
                d.children = null;
            }
        }

        // Expand node
        function expand(d) {
            if (d._children) {
                d.children = d._children;
                d._children = null;
            }
        }

        // Initial render
        update(root);

        // Center initial view
        svg.call(zoom.transform, d3.zoomIdentity.translate(100, height / 2));
        
        } // End of initializeMindmap()

        // Global functions for button controls (must be outside initializeMindmap)
        let root, update, collapse, zoom, svg;

        function expandAll() {
            if (!root) return;
            function expandRecursive(d) {
                if (d._children) {
                    d.children = d._children;
                    d._children = null;
                }
                if (d.children) {
                    d.children.forEach(expandRecursive);
                }
            }
            expandRecursive(root);
            update(root);
        }

        function collapseAll() {
            if (!root) return;
            root.children.forEach(collapse);
            update(root);
        }

        function resetZoom() {
            if (!svg || !zoom) return;
            const height = window.innerHeight - 120;
            svg.transition()
                .duration(750)
                .call(zoom.transform, d3.zoomIdentity.translate(100, height / 2));
        }
    </script>
</body>
</html>
